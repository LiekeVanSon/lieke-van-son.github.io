<!DOCTYPE HTML>
<!--
	Massively by HTML5 UP
	html5up.net | @ajlkn
	Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->
<html>
	<head>
		
		<!-- Google tag (gtag.js) -->
		<script async src="https://www.googletagmanager.com/gtag/js?id=G-FEKVVHCKS3"></script>
		<script>
		  window.dataLayer = window.dataLayer || [];
		  function gtag(){dataLayer.push(arguments);}
		  gtag('js', new Date());

		  gtag('config', 'G-FEKVVHCKS3');
		</script>

		
		<title> Lieke van Son </title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=0.9, user-scalable=no" />
		<link rel="stylesheet" href="assets/css/main.css" />
		<noscript><link rel="stylesheet" href="assets/css/noscript.css" /></noscript>
		  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  		<script id="MathJax-script" async
          	src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
 		 </script>

        <!-- Link to your left-menu.css file -->
        <link rel="stylesheet" href="assets/css/left-menu.css" />

        <!-- Adding latex support -->
          <script>
            MathJax = {
              tex: {
                inlineMath: [['$', '$']]
              }
            };
          </script>
          
          <script type="text/javascript" id="MathJax-script" async
            src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
          </script>
          
         
	</head>


<!-- Start Body -->
	<body class="is-preload">

        <!-- Left menu button -->
        <div id="left-menu-button">Hackathon Menu</div>

        <!-- Hidden left menu -->
        <div id="left-menu">
            <ul>
                <li><a href="IAU_hackathon2024.html">Getting started</a></li>
                <li><a href="day1.html">Day 1</a></li>
                <li><a href="day2.html">Day 2</a></li>
            </ul>
        </div>


		<!-- Wrapper -->
			<div id="wrapper">

				<!-- Header -->
					<header id="header">
						<a href="IAU_hackathon2024.html" class="logo"> A first taste of MESA </a>
					</header>

                <!-- Top navigation -->
					<nav id="nav">
						<ul class="links">
							<li><a href="index.html">About</a></li>
							<li><a href="publications.html">Publications</a></li>
							<li><a href="research.html">my research</a></li>
							<li><a href="talks.html">Talks</a></li>
							<li><a href="outreach.html">Outreach</a></li>
							<li class="active"><a href="IAU_hackathon2024.html">Teaching</a></li>
							<li><a href="CV.html">CV</a></li>
							<li><a href="contact.html">Contact</a></li>
						</ul>
						<ul class="icons">
							<li><a href="https://www.linkedin.com/in/lieke-van-son-128796b4/" class="icon brands alt fa-linkedin"><span class="label">LinkedIn</span></a></li>
							<li><a href="https://github.com/LiekeVanSon/" class="icon brands fa-github"><span class="label">GitHub</span></a></li> 
						</ul>
					</nav>

				<!-- Main -->
					<div id="main">
						<p> 
       

<!-- -------------------------------------------------------------------------------------------------------------- -->
<!-- -------------------------------------------------------------------------------------------------------------- -->

<section>


	<h1> Day 1: getting familiar with MESA </h1> 
	
	<h2>What is MESA? </h2> 

	<p>
	MESA stands for Modules for Experiments in Stellar Astrophysics. 
	It is a software package that can be used to simulate the evolution of stars.
	
	Will add slides here. 
	
	</p>
	

	
	</section>

<!-- -------------------------------------------------------------------------------------------------------------- -->


<section>

<h2>'Using MESA' tutorial on the MESA website</h2>

<p style="color:red;">
  We will start by following the instructions on 
  <a href="https://docs.mesastar.org/en/latest/using_mesa/running.html" style="font-weight: bold; color: rgb(0, 140, 222);"> the MESA website </a>
  Note that the following text is copied from the MESA website!
</p>
	
  <p>This page has information about how to use MESA to evolve a single star.  
	It assumes you have already installed MESA (see <a href="#installation">Installing MESA</a>).</p>

  <p>The <code>$MESA_DIR</code> directory has lots of subdirectories.  Most of these
    subdirectories are modules (the "M" in MESA) that provide some
    specific functionality (e.g., "kap" provides routines for calculating
    opacities). The most important module is "star", which contains the
    module that knows how to put the capabilities of all the other modules
    together and advance the state of a stellar model by a single step and
    then suggest a new time increment for the next step.  Basically,
    that's all it does.</p>
  <p>You came here for a program that can use these modules to do
    multi-step stellar evolution. You're in luck, because such a program
    lives in the star/work directory, so that's where we'll start.</p>
  
  <h3>Make a copy of the star/work directory</h3>
  <p>You should perform and store your work somewhere other than the main
    MESA directory. This will make your life simpler when you do a fresh
    checkout of a new MESA version at some point in the future. Therefore
    each time you want to start a new MESA project, you should make a new
    copy of the star/work directory. Let's do that for this tutorial.</p>

  <pre>
    <code>
    cp -r $MESA_DIR/star/work ~/tutorial
    </code>
  </pre>


  <p>Now that we have our copy of the work directory, we need to compile the
    code that lives in it.</p>

  <pre>
	<code>
    cd tutorial
    ./mk
	</code>
  </pre>
  
  <h3>Set up configuration files</h3>

  <p>The work directory already contains a set of simple configuration files
    that will evolve a 15 solar mass star through on to the zero-age main
    sequence (core hydrogen ignition). For now, you won't need to edit
    anything, but you should take a look at each of these files.</p>


  <h4>inlist</h4>

  <There>This is the first inlist file that MESA reads when it starts.  The
    file <code>inlist</code> is often used to direct MESA to read one or more other
    inlist files.
	
	There are five sections (technically Fortran "namelists") in star inlist files:</p>
  <ul>
    <li><strong>star_job</strong> - options for the program that evolves the star</li>
    <li><strong>eos</strong> - options for the MESA eos module</li>
    <li><strong>kap</strong> - options for the MESA kap module</li>
    <li><strong>controls</strong> - options for the MESA star module</li>
    <li><strong>pgstar</strong> - options for on-screen plotting</li>
  </ul>

  <p>Each definition in a namelist is of the form:</p>

  <pre>
	<code class="language-fortran">
    name = value ! comment
	</code>
  </pre>

  <p>Values are specified using the normal Fortran syntax. Blank lines and comment lines can be freely included in the list. Blanks at the start of a line containing a name-value pair are okay too so you can (and should) indent things to make them more readable.</p>

  <p>All of the controls are given reasonable default values at initialization, so you only need to set the ones that you actually want to change.</p>
  
	</section>

  <!-- -------------------------------------------------------------------------------------------------------------- -->

  <section>

  <h2>Run MESA</h2>
  <p>Running the code is now as simple as typing:</p>
  
  <pre><code>./rn
  </code></pre>
  
  <p>MESA will keep you updated via terminal output that looks like this:</p>
  
  <pre><code>step    lg_Tmax     Teff     lg_LH      lg_Lnuc     Mass       H_rich     H_cntr     N_cntr     Y_surf   eta_cntr   zones  retry
  lg_dt_yrs    lg_Tcntr    lg_R     lg_L3a     lg_Lneu     lg_Mdot    He_core    He_cntr    O_cntr     Z_surf   gam_cntr   iters
	age_yrs    lg_Dcntr    lg_L     lg_LZ      lg_Lphoto   lg_Dsurf   CO_core    C_cntr     Ne_cntr    Z_cntr   v_div_cs       dt_limit
  __________________________________________________________________________________________________________________________________________________
  
		200   7.468401  2.865E+04   4.240859   4.240859  15.000000  15.000000   0.699697   0.003104   0.280000  -5.917248    864      3
  3.3257E+00   7.468401   0.795655 -32.911837   3.063854 -99.000000   0.000000   0.280004   0.009379   0.020000   0.014657      5
  5.0236E+04   0.611187   4.374553 -99.000000 -99.000000  -9.031542   0.000000   0.001654   0.002085   0.020299  0.000E+00  max increase
  </code></pre>
  
  <p>MESA will also display some pgstar plots that look like:</p>
  
  <p><img src="images/IAUhackathonImages/hr_000200.png" alt="HR Diagram"></p>
  
  <p><img src="images/IAUhackathonImages/trho_profile_000200.webp" alt="TRho Profile"></p>
  
  <p>This should run for 208 steps before stopping with the following message:</p>
  
  <pre><code>stop because Lnuc_div_L >= Lnuc_div_L_zams_limit
  </code></pre>
  
</section>


</section>





<!-- -------------------------------------------------------------------------------------------------------------- -->
<!-- -------------------------------------------------------------------------------------------------------------- -->
		

<section>


<h2><a href="https://docs.mesastar.org/en/latest/using_mesa/output.html#">MESA output</a> </h2>


<p style="color:red;">
  Similar to above, we will continue by following the instructions on MESA output
  <a href="https://docs.mesastar.org/en/latest/using_mesa/output.html#l" style="font-weight: bold; color: rgb(0, 140, 222);"> following MESA website </a>
  Note that the following text is copied from the MESA website!
</p>

<h3>Output files</h3>


<p>
By default, MESA stores its data in the `LOGS` directory. 
The data files are text-based and can fed into your favorite plotting program. 
You should visit the <a href="http://cococubed.com/mesa_market/add-ons.html">Add-ons</a> section
of the MESA forum and see if someone has contributed code in your language of choice. (There are reasonably mature routines for python,
IDL, ruby and Mathematica.) An example of python plotting is shown later on this page.
</p>

In the LOGS directory, you'll find the following files.: <br><br>

<h3>history.data</h3>

<p>
The history for the run is saved, one line per logged model, in the file
"history.data". The first line of history.data has column numbers, the
second line has column names, and the following lines have the
corresponding values. In case of a restart, lines are not
removed from the history.data; instead new values are simply appended to
the end of the file. As a result the model_numbers are not guaranteed to
be monotonically increasing in the log. The code that uses the history
must bear the burden of removing lines that have been made obsolete.
This can most easily be done by storing
the data into arrays as it is read using the model_number as the array
index. That way you'll automatically discard obsolete values by
overwriting them with the newer ones that appear later in the history
file.
</p>

<h3>profiles.index</h3>

<p>
MESA doesn't store profiles for every step (that'd take up too much
space). This list tells you how to translate between the numbers in the
profile filenames and the MESA model numbers. By default, MESA will
store a profile at the end of the run.
</p>

<p>
For each profile, there is a line in profiles.index giving the model
number, its priority, and its profile number. Priority level 2 is for
models saved because of some special event in the evolution such as the
onset of helium burning. Priority level 1 is for models saved because
the number of models since the most recent profile has reached the
currently setting of the profile_interval parameter.
</p>

<h3>profile.data</h3>

<p>
The profiles contain detailed information about a selected set of
models, one model per file. The name of the profile data file is
determined by the profile number. For example, if the profile number is
15, the profile data will be found in the file named 'profile15.data'.
</p>

<p>
Each profile includes both a set of global properties of the star, such
as its age, and a large set of properties for each point in the model of
the star given one line per point. In each case, the lines of data are
preceded by a line with column numbers and a line with column names.
</p>



<h3>Selecting output quantities</h3>

<p>
The default MESA output is set by the files

<pre>
  <code>
   $MESA_DIR/star/defaults/history_columns.list
   $MESA_DIR/star/defaults/profile_columns.list
  </code>
</pre>

In order to customize the output, copy these files to your work
directory

<pre>
  <code>
   cp $MESA_DIR/star/defaults/history_columns.list .
   cp $MESA_DIR/star/defaults/profile_columns.list .
  </code>
</pre>

<p>
Then, open up history_columns.list or profile_columns.list in a text
editor. The file describes the full list of the available options. To
add/remove the columns of interest, comment/uncomment any lines ('!' is
the comment character).
</p>

<p>
But what if you want a history or profile quantity that isn't on the
list? For that, you'll want to <code>use run_star_extras.f </code> 
<p style="color:red;">Which we will discuss on day 2!</p>
</p>


<h3>Plotting MESA output</h3>

<p>
While pgstar is great for observing your stellar models evolving in real
time and for quickly making videos, more complicated and higher-quality
plots require post-processing in another environment. Perhaps the most
popular environment in recent years is Python, and in particular, via
the `numpy <http://www.numpy.org>`__ and
`matplotlib <//matplotlib.org>`__ packages.
</p>

<p>
While you may want to write your own tools to read and analyze the
output of your MESA calculations, `many already
exist <http://cococubed.com/mesa_market/add-ons.html>`__. In that
vein, we introduce a simple module for use in python scripts and
interactive sessions called ``mesa_reader``, which only requires
`numpy <//www.numpy.org>`__.
</p>


<h3>What is MESA Reader?</h3>

<p>
``mesa_reader`` is a module consisting of three classes that you can use
to read in the contents of a typical ``LOGS`` directory. These three
classes are called ``MesaData``, which corresponds to data in profiles
or history files, ``MesaProfileIndex``, which corresponds to data found
in ``profiles.index``, and ``MesaLogDir``, which ties together data in
profiles, the profile index, and the history file.
</p>


<h3>
Examples
</h3>

<p>
Full documentation for how MESA Reader is installed and how to use the
three classes can be found at the project's `Github
repository <https://github.com/wmwolf/py_mesa_reader>`__ and
accompanying
`documentation <//wmwolf.github.io/py_mesa_reader>`__. Below, we
show some simple example use cases of MESA Reader.
</p>


The Basics
^^^^^^^^^^

<pre>
  <code class="language-python">
  # import mesa_reader to make its classes accessible
  import mesa_reader as mr

  # make a MesaData object from a history file
  h = mr.MesaData('LOGS/history.data')

  # extract the star_age column of data
  ages = h.data('star_age')

  # or do it more succinctly
  ages = h.star_age

  </code>
</pre>


<p>
here, ``ages`` is now a numpy array that has the same values as are in
our ``LOGS/history.data`` file under the ``star_age`` header.
</p>

<p>
That's how to set up a history file, but what about profiles? We can do
the same thing if we know the exact file we want to load:
</p>

<pre>
  <code class="language-python">
   import mesa_reader as mr

   # load the profile file into a MesaData instance
   p = mr.MesaData('LOGS/profile1.data')

   # access the temperature column of data
   temperatures = 10 ** p.logT
  </code>
</pre>

<p>
But often it's frustrating to know exactly what profile file you want to
load, so we can use the ``MesaLogDir`` class to simplify the process. It
lets us load profiles by their associated model number and most simply
by just loading the last saved profile:
</p>


<pre>
  <code class="language-python">
   import mesa_reader as mr

   l = mr.MesaLogDir('./LOGS')

   # load the profile associated with model number 100
   p_100 = l.profile_data(100)
   # the same as the following
   p_100 = l.profile_data(model_number=100)

   # load the profile with PROFILE number 12
   p_12 = l.profile_data(profile_number=12)

   # load the last profile saved (largest model number)
   p_last = l.profile_data()
  </code>
</pre>

<p>
There are many ways to get at specific profile files and even to select
profiles based on criteria in the history file. See the full
`documentation <//wmwolf.github.io/py_mesa_reader>`__ for more.
</p>


<h3>An HR Diagram</h3>

<p>
Okay, how about making a plot with this data? MESA Reader has no
implicit plotting capabilities, but it makes plotting in other
environments dead simple. For this example, we'll use matplotlib and
assume that it is being used in pylab's interactive mode:
</p>

<pre>
  <code class="language-python">
   # start pylab mode
   %pylab
   # import mesa_reader
   import mesa_reader as mr

   # load and plot data
   h = mr.MesaData('LOGS/history.data')
   plot(h.log_Teff, h.log_L)

   # set axis labels
   xlabel('log Effective Temperature')
   ylabel('log Luminosity')

   # invert the x-axis
   plt.gca().invert_xaxis()
  </code>
</pre>

<p>
For an example run simulating a massive pulsating star, this produces
something like the following image:

|sample hr diagram plot|

Don't worry if your plot has a different style than this, as that is
just a function of your ``matplotlibrc`` file, which won't be discussed
here.
</p>

<h3>A Temperature-Density Profile</h3>

<p>
To plot a temperature-density profile, the process is very similar:

<pre>
  <code class="language-python">
   %pylab
   import mesa_reader as mr

   # load entire LOG directory information
   l = mr.MesaLogDir('./LOGS')
   # grab the last profile
   p = l.profile_data()

   # this works even if you only have logRho and logT!
   loglog(p.Rho, p.T)
   xlabel("Density")
   ylabel("Temperature")
  </code>
</pre>

<p>
which produces something like the following image:

|sample T-Rho profile|
</p>


<h3>Going Beyond</h3>

<p>
MESA Reader is very general and is not just a tool to extract data
columns for simple plotting (though that is perhaps the most obvious
use). You can use it to filter through your data, selecting only periods
or profiles that are match some criterion (say, profiles that were taken
when the star was in a particular region of the HR diagram). More
complicated plots can be made, like Kippenhahn diagrams, with a little
bit more clever work.
</p>


</section>

<!-- -------------------------------------------------------------------------------------------------------------- -->
<!-- -------------------------------------------------------------------------------------------------------------- -->
												
           
				<!-- Copyright -->
					<div id="copyright">
						<ul><li>&copy; Untitled</li><li>Design: <a href="https://html5up.net">HTML5 UP</a></li></ul>
					</div>

			</div>

		<!-- Scripts -->
			<script src="assets/js/jquery.min.js"></script>
			<script src="assets/js/jquery.scrollex.min.js"></script>
			<script src="assets/js/jquery.scrolly.min.js"></script>
			<script src="assets/js/browser.min.js"></script>
			<script src="assets/js/breakpoints.min.js"></script>
			<script src="assets/js/util.js"></script>
			<script src="assets/js/main.js"></script>
            <!-- for left button  -->
            <script>
                document.getElementById('left-menu-button').addEventListener('mouseover', function() {
                    document.getElementById('left-menu').style.display = 'block';
                });

                document.getElementById('left-menu').addEventListener('mouseleave', function() {
                    document.getElementById('left-menu').style.display = 'none';
                });
            </script>

	</body>
</html>



