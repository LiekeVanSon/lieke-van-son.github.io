<!DOCTYPE HTML>
<!--
	Massively by HTML5 UP
	html5up.net | @ajlkn
	Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->
<html>
	<head>
		
		
		<title> Lieke van Son </title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=0.9, user-scalable=no" />
		<link rel="stylesheet" href="../assets/css/main.css" />
		<noscript><link rel="stylesheet" href="../assets/css/noscript.css" /></noscript>
		  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  		<script id="MathJax-script" async
          	src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
 		 </script>

        <!-- Link to your left-menu.css file -->
        <link rel="stylesheet" href="../assets/css/left-menu.css" />

        <!-- Adding latex support -->
          <script>
            MathJax = {
              tex: {
                inlineMath: [['$', '$']]
              }
            };
          </script>
          
          <script type="text/javascript" id="MathJax-script" async
            src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
          </script>
          
         
	</head>


<!-- Start Body -->
	<body class="is-preload">

        <!-- Left menu button -->
        <div id="left-menu-button">Hackathon Menu</div>

        <!-- Hidden left menu -->
        <div id="left-menu">
            <ul>
              <li><a href="../IAUhackathon/home.html">Getting started</a></li>
              <li><a href="../IAUhackathon/part1.html">Part 1</a></li>
              <ul style="padding-left: 20px;">
                <li><a href="../IAUhackathon/RunningMESA.html">Running MESA </a></li>
                <li><a href="../IAUhackathon/MESAoutput.html">MESA Output </a></li>
              </ul>
              <li><a href="../IAUhackathon/part2.html">Part 2</a></li>
              <ul style="padding-left: 20px;">
                <li><a href="../IAUhackathon/Rotation.html">Rotation </a></li>
                <li><a href="../IAUhackathon/AMtransport.html">AM Transport </a></li>
                <li><a href="../IAUhackathon/Winds.html">Winds </a></li>
                <li><a href="../IAUhackathon/final_proj.html">Spin it! </a></li>
              </ul>
            </ul>
        </div>


		<!-- Wrapper -->
			<div id="wrapper">

				<!-- Header -->
					<header id="header">
						<a href="../IAUhackathon/home.html" class="logo"> A first taste of MESA </a>
					</header>

                <!-- Top navigation -->
					<nav id="nav">
						<ul class="links">
							<li><a href="../index.html">About</a></li>
							<li><a href="../publications.html">Publications</a></li>
							<li><a href="../research.html">research</a></li>
							<li><a href="../talks.html">Talks</a></li>
							<li><a href="../outreach.html">Outreach</a></li>
							<li class="active"><a href="../IAUhackathon/home.html">Teaching</a></li>
							<li><a href="../CV.html">CV</a></li>
							<li><a href="../opportunities.html">Opportunities</a></li>
						</ul>
						<ul class="icons">
							<li><a href="https://www.linkedin.com/in/lieke-van-son-128796b4/" class="icon brands alt fa-linkedin"><span class="label">LinkedIn</span></a></li>
							<li><a href="https://github.com/LiekeVanSon/" class="icon brands fa-github"><span class="label">GitHub</span></a></li> 
						</ul>
					</nav>

				<!-- Main -->
					<div id="main">
						<p> 
       

<!-- -------------------------------------------------------------------------------------------------------------- -->
<!-- -------------------------------------------------------------------------------------------------------------- -->

<section>


<h1><a href="https://docs.mesastar.org/en/latest/using_mesa/output.html#">MESA output</a> </h1>


<p style="color:red;">
  Similar to before, we will continue by following the instructions on MESA output
  <a href="https://docs.mesastar.org/en/latest/using_mesa/output.html#l" style="font-weight: bold; color: rgb(0, 140, 222);"> following MESA website </a>
  Note that the following text is copied from the MESA website!
</p>

<h3>Output files</h3>


<p>
By default, MESA stores its data in the `LOGS` directory. 
The data files are text-based and can fed into your favorite plotting program. 
You should visit the <a href="http://cococubed.com/mesa_market/add-ons.html">Add-ons</a> section
of the MESA forum and see if someone has contributed code in your language of choice. (There are reasonably mature routines for python,
IDL, ruby and Mathematica.) An example of python plotting is shown later on this page.
</p>

In the LOGS directory, you'll find the following files.: <br><br>

<h3>history.data</h3>

<p>
The history for the run is saved, one line per logged model, in the file
"history.data". The first line of history.data has column numbers, the
second line has column names, and the following lines have the
corresponding values. In case of a restart, lines are not
removed from the history.data; instead new values are simply appended to
the end of the file. <b> As a result the model_numbers are not guaranteed to
be monotonically increasing in the log.</b> The code that uses the history
must bear the burden of removing lines that have been made obsolete.
This can most easily be done by storing
the data into arrays as it is read using the model_number as the array
index. That way you'll automatically discard obsolete values by
overwriting them with the newer ones that appear later in the history
file.
</p>

<h3>profiles.index</h3>

<p>
MESA doesn't store profiles for every step (that'd take up too much
space). This list tells you how to translate between the numbers in the
profile filenames and the MESA model numbers. By default, MESA will
store a profile at the end of the run.
</p>

<p>
For each profile, there is a line in <code>profiles.index</code> giving the model
number, its priority, and its profile number. Priority level 2 is for
models saved because of some special event in the evolution such as the
onset of helium burning. Priority level 1 is for models saved because
the number of models since the most recent profile has reached the
currently setting of the profile_interval parameter.
</p>

<h3>profile.data</h3>

<p>
The profiles contain detailed information about a selected set of
models, one model per file. The name of the profile data file is
determined by the profile number. For example, if the profile number is
15, the profile data will be found in the file named 'profile15.data'.
</p>

<p>
Each profile includes both a set of global properties of the star, such
as its age, and a large set of properties for each point in the model of
the star given one line per point. In each case, the lines of data are
preceded by a line with column numbers and a line with column names.
</p>



<h3>Selecting output quantities</h3>

<p>
The default MESA output is set by the files

<pre><code>$MESA_DIR/star/defaults/history_columns.list
$MESA_DIR/star/defaults/profile_columns.list
</code></pre>

In order to customize the output, copy these files to your work
directory

<pre><code>cp $MESA_DIR/star/defaults/history_columns.list .
cp $MESA_DIR/star/defaults/profile_columns.list .
</code></pre>

<p>
Then, open up history_columns.list or profile_columns.list in a text
editor. The file describes the full list of the available options. To
add/remove the columns of interest, comment/uncomment any lines ('!' is
the comment character).
</p>

<p>
But what if you want a history or profile quantity that isn't on the
list? For that, you'll want to use <code>run_star_extras.f </code> 
<span style="color:red;">Which is a file we will discuss in Part 2!</span>
</p>


<h2>Plotting MESA output</h2>

<p>
While pgstar is great for observing your stellar models evolving in real
time and for quickly making videos, more complicated and higher-quality
plots require post-processing in another environment. Perhaps the most
popular environment in recent years is Python, and in particular, via
the <a href="http://www.numpy.org">numpy</a> and <a href="http://matplotlib.org">matplotlib</a> packages.
</p>

<p>
While you may want to write your own tools to read and analyze the
output of your MESA calculations, <a href="http://cococubed.com/mesa_market/add-ons.html">many already exist</a>. 
In that vein, we introduce a simple module for use in python scripts and
interactive sessions called <span style="color:rgb(0, 64, 255); font-weight:bold;">mesa_reader</span>, which only requires
<a href="http://www.numpy.org">numpy</a>.
</p>


<h3>What is MESA Reader?</h3>

<p>
``mesa_reader`` is a module consisting of three classes that you can use
to read in the contents of a typical ``LOGS`` directory. These three
classes are called ``MesaData``, which corresponds to data in profiles
or history files, ``MesaProfileIndex``, which corresponds to data found
in ``profiles.index``, and ``MesaLogDir``, which ties together data in
profiles, the profile index, and the history file.
</p>


<h3>
Examples
</h3>

<p>
Full documentation for how MESA Reader is installed and how to use the
three classes can be found at the project's <a href="https://github.com/wmwolf/py_mesa_reader">Github repository</a> 
and accompanying <a href="//wmwolf.github.io/py_mesa_reader">documentation</a>.
Below, we show some simple example use cases of MESA Reader.
</p>

<p style="color:rgb(255, 0, 0); ">
    We have pre-installed mesa_reader for you on the cluster. If you would like to use it at home, you will want to <code>git clone https://github.com/wmwolf/py_mesa_reader.git</code>
    and then <code>python setup.py install</code> 
</p>

<p style="color:rgb(255, 0, 0); ">
  Let's open up a Notebook through the JupyterHub Launcher and try out the following examples:
</p>

<h3>The Basics</h3>

<pre><code class="language-python"># import mesa_reader to make its classes accessible
import mesa_reader as mr

# make a MesaData object from a history file
h = mr.MesaData('LOGS/history.data')

# extract the star_age column of data
ages = h.data('star_age')

# or do it more succinctly
ages = h.star_age
</code></pre>


<p>
here, ``ages`` is now a numpy array that has the same values as are in
our ``LOGS/history.data`` file under the ``star_age`` header.
</p>

<p>
That's how to set up a history file, but what about profiles? We can do
the same thing if we know the exact file we want to load:
</p>

<pre><code class="language-python"># load the profile file into a MesaData instance
p = mr.MesaData('LOGS/profile1.data')

# access the temperature column of data
temperatures = 10 ** p.logT
</code></pre>

<p>
But often it's frustrating to know exactly what profile file you want to
load, so we can use the ``MesaLogDir`` class to simplify the process. It
lets us load profiles by their associated model number and most simply
by just loading the last saved profile:
</p>


<pre><code class="language-python">l = mr.MesaLogDir('./LOGS')

# load the profile associated with model number 300
p_300 = l.profile_data(300)
# the same as the following
p_300 = l.profile_data(model_number=300)

# load the profile with PROFILE number 12
p_12 = l.profile_data(profile_number=12)

# load the last profile saved (largest model number)
p_last = l.profile_data()
</code></pre>

<p>
There are many ways to get at specific profile files and even to select
profiles based on criteria in the history file. See the full
<a href="//wmwolf.github.io/py_mesa_reader">documentation</a> for more.
</p>


<h3>An HR Diagram</h3>

<p>
Okay, how about making a plot with this data? MESA Reader has no
implicit plotting capabilities, but it makes plotting in other
environments dead simple. For this example, we'll use matplotlib:
</p>

%matplotlib inline
<pre><code class="language-python"># import matplotlib 
import matplotlib.pyplot as plt 

# import mesa_reader
import mesa_reader as mr
# and matplotlib
import matplotlib.pyplot as plt

# load and plot data
h = mr.MesaData('LOGS/history.data')
plt.plot(h.log_Teff, h.log_L)

# set axis labels
plt.xlabel('log Effective Temperature')
plt.ylabel('log Luminosity')

# invert the x-axis
plt.gca().invert_xaxis()

plt.show()
</code></pre>



<p>
Using the output from the tutorial, this produces
something like the following image:
</p>


<div style="align: left; text-align:center;">
    <img src="../IAUhackathon/IAUhackathonImages/HR_MESAoutput.png" width="70%" /> 
</div> 

<p>
Don't worry if your plot has a different style than this, as that is
just a function of your ``matplotlibrc`` settings, which won't be discussed here.
</p> 




<h3>A Temperature-Density Profile</h3>

<p>
To plot a temperature-density profile, the process is very similar:

<pre><code class="language-python">import mesa_reader as mr
import matplotlib.pyplot as plt

# load entire LOG directory information
l = mr.MesaLogDir('./LOGS')
# grab the last profile
p = l.profile_data()

# this works even if you only have logRho and logT!
plt.loglog(p.Rho, p.T)
plt.xlabel("Density")
plt.ylabel("Temperature")

plt.show()</code></pre>

<p>
which produces something like the following image:


<div style="align: left; text-align:center;">
    <img src="../IAUhackathon/IAUhackathonImages/Trho_MESAoutput.png" width="50%" /> 
</div>

</p>


<h3>Going Beyond</h3>

<p>
MESA Reader is very general and is not just a tool to extract data
columns for simple plotting (though that is perhaps the most obvious
use). You can use it to filter through your data, selecting only periods
or profiles that are match some criterion (say, profiles that were taken
when the star was in a particular region of the HR diagram). More
complicated plots can be made, like Kippenhahn diagrams, with a little
bit more clever work.

</p>


<p style="color:rgb(255, 0, 0); ">
    To read about what a `Kippenhahn diagram' is, see <a href="https://www.astro.ru.nl/~onnop/education/stev_utrecht_notes/">Onno Pols' lecture note</a>.
    E.g., in Chapter 10, Fig. 10.5. 
</p>

</section>

<!-- -------------------------------------------------------------------------------------------------------------- -->
<!-- -------------------------------------------------------------------------------------------------------------- -->
												
           
				<!-- Copyright -->
					<div id="copyright">
						<ul><li>&copy; Untitled</li><li>Design: <a href="https://html5up.net">HTML5 UP</a></li></ul>
					</div>

			</div>

		<!-- Scripts -->
			<script src="assets/js/jquery.min.js"></script>
			<script src="assets/js/jquery.scrollex.min.js"></script>
			<script src="assets/js/jquery.scrolly.min.js"></script>
			<script src="assets/js/browser.min.js"></script>
			<script src="assets/js/breakpoints.min.js"></script>
			<script src="assets/js/util.js"></script>
			<script src="assets/js/main.js"></script>
      <!-- Script for solution toggle button -->
      <script src="../assets/js/togglesol.js"></script>
            <!-- for left button  -->
            <script>
                document.getElementById('left-menu-button').addEventListener('mouseover', function() {
                    document.getElementById('left-menu').style.display = 'block';
                });

                document.getElementById('left-menu').addEventListener('mouseleave', function() {
                    document.getElementById('left-menu').style.display = 'none';
                });
            </script>

	</body>
</html>



